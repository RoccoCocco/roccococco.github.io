<html>
  <head>
    <title>Showing/Hiding Overlays</title>
  </head>

  <style>
    #map {
      height: 100%;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    .custom-map-control-button {
      background-color: #fff;
      border: 0;
      border-radius: 2px;
      box-shadow: 0 1px 4px -1px rgba(0, 0, 0, 0.3);
      margin: 10px;
      padding: 0 0.5em;
      font:
        400 18px Roboto,
        Arial,
        sans-serif;
      overflow: hidden;
      height: 40px;
      cursor: pointer;
    }
    .custom-map-control-button:hover {
      background: rgb(235, 235, 235);
    }
  </style>
  <body>
    <div id="map"></div>

    <script>
      // This example adds hide() and show() methods to a custom overlay's prototype.
      // These methods toggle the visibility of the container <div>.
      // overlay to or from the map.
      function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 13,
          center: { lat: 43.548348, lng: 16.478911 },
          mapTypeId: "satellite",
          tilt: 0,
        });

        const bounds = new google.maps.LatLngBounds(
          new google.maps.LatLng(43.520514002965356, 16.456432406579594),
          new google.maps.LatLng(43.56770322685575, 16.53496748653565),
        );

        let image = "overlay.svg";
        /**
         * The custom USGSOverlay object contains the USGS image,
         * the bounds of the image, and a reference to the map.
         */
        class USGSOverlay extends google.maps.OverlayView {
          bounds;
          image;
          div;

          img;
          constructor(bounds, image) {
            super();
            this.bounds = bounds;
            this.image = image;
          }
          /**
           * onAdd is called when the map's panes are ready and the overlay has been
           * added to the map.
           */
          onAdd() {
            this.div = document.createElement("div");
            this.div.style.borderStyle = "none";
            this.div.style.borderWidth = "0px";
            this.div.style.position = "absolute";
            this.div.style.opacity = "0.5";

            // Create the img element and attach it to the div.
            const img = document.createElement("img");

            img.src = this.image;
            img.style.width = "100%";
            img.style.height = "100%";
            img.style.position = "absolute";
            img.style.transform = "rotate(-1deg)";
            this.div.appendChild(img);

            // Add the element to the "overlayLayer" pane.
            const panes = this.getPanes();

            panes.overlayLayer.appendChild(this.div);
          }
          draw() {
            const overlayProjection = this.getProjection();
            const sw = overlayProjection.fromLatLngToDivPixel(
              this.bounds.getSouthWest(),
            );
            const ne = overlayProjection.fromLatLngToDivPixel(
              this.bounds.getNorthEast(),
            );

            // Resize the image's div to fit the indicated dimensions.
            if (this.div) {
              this.div.style.left = sw.x + "px";
              this.div.style.top = ne.y + "px";
              this.div.style.width = ne.x - sw.x + "px";
              this.div.style.height = sw.y - ne.y + "px";
            }
          }
          /**
           * The onRemove() method will be called automatically from the API if
           * we ever set the overlay's map property to 'null'.
           */
          onRemove() {
            if (this.div) {
              this.div.parentNode.removeChild(this.div);
              delete this.div;
            }
          }
          /**
           *  Set the visibility to 'hidden' or 'visible'.
           */
          hide() {
            if (this.div) {
              this.div.style.visibility = "hidden";
            }
          }
          show() {
            if (this.div) {
              this.div.style.visibility = "visible";
            }
          }
          setOpacity(o) {
            this.show();
            this.div.style.opacity = (o / 100).toFixed(2);
          }
          toggle() {
            if (this.div) {
              if (this.div.style.visibility === "hidden") {
                this.show();
              } else {
                this.hide();
              }
            }
          }
          toggleDOM(map) {
            if (this.getMap()) {
              this.setMap(null);
            } else {
              this.setMap(map);
            }
          }
        }

        const overlay = new USGSOverlay(bounds, image);

        overlay.setMap(map);

        const toggleButton = document.createElement("button");

        toggleButton.textContent = "Toggle";
        toggleButton.classList.add("custom-map-control-button");

        const createOpacityButton = (o) => {
          const button = document.createElement("button");
          button.classList.add("custom-map-control-button");
          button.textContent = `${o}%`;
          button.addEventListener("click", () => {
            overlay.setOpacity(o);
          });

          return button;
        };

        const opacity75 = createOpacityButton(75);
        const opacity50 = createOpacityButton(50);
        const opacity25 = createOpacityButton(25);

        const toggleDOMButton = document.createElement("button");

        toggleDOMButton.textContent = "Toggle DOM Attachment";
        toggleDOMButton.classList.add("custom-map-control-button");
        toggleButton.addEventListener("click", () => {
          overlay.toggle();
        });
        toggleDOMButton.addEventListener("click", () => {
          overlay.toggleDOM(map);
        });
        //map.controls[google.maps.ControlPosition.TOP_RIGHT].push(
        //  toggleDOMButton,
        //);
        map.controls[google.maps.ControlPosition.TOP_RIGHT].push(toggleButton);
        map.controls[google.maps.ControlPosition.TOP_RIGHT].push(opacity25);
        map.controls[google.maps.ControlPosition.TOP_RIGHT].push(opacity50);
        map.controls[google.maps.ControlPosition.TOP_RIGHT].push(opacity75);
      }

      window.initMap = initMap;
    </script>

    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyClcomDmZE1GNYTob9tKyo5UiH9Tn323gs&callback=initMap&v=weekly"
      defer
    ></script>
  </body>
</html>
